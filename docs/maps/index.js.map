{"version":3,"sources":["index.js"],"names":["gameSpecificCycleCounts","RB","Y","gameRoll2Counts","roll2Counts","$","data","actualRateBar","intendedRateBar","loadingSpinner","setRateBar","progressElement","percent","parseFloat","toFixed","find","html","css","attr","className","getJsonValue","$element","JSON","parse","val","getIntValue","parseInt","on","removeClass","pokemon","game","includes","name","catchRate","ball","level","currentHPPercent","status","Promise","all","Array","map","x","i","hpDV","maxHP","baseHP","currentHPModifier","hpFactor","ballFactor","Math","min","catchRateData","ballRerollCutoff","ballReroll1","reroll1","ballReroll2","reroll2","reroll1Count","reroll2Count","roll2Count","ballIndex","ballName","resolve","reject","catchRateWorker","Worker","onmessage","e","postMessage","createCatchRateWorker","then","results","actualRate","intendedRate","forEach","result","addClass","this","value","max"],"mappings":"AAAA,MAAMA,wBAA0B,CAC5BC,GAAI,CAAC,IAAK,KACVC,EAAG,CAAC,IAAK,MAEPC,gBAAkB,CACpBF,GAAI,EACJC,EAAG,KAEDE,YAAcC,EAAE,gBAAgBC,KAAK,eAC3C,IAAIC,cAAgBF,EAAE,oBAClBG,gBAAkBH,EAAE,sBACpBI,eAAiBJ,EAAE,mBAEvB,SAASK,WAAWC,EAAiBC,GACjCA,EAAUC,WAAWD,GAASE,QAAQ,GACtCH,EAAgBI,KAAK,UAAUC,KAAQJ,EAAH,KACpCD,EAAgBI,KAAK,iBAAiBE,IAAI,QAAYL,EAAH,KAAeM,KAAK,gBAAiBN,GAAS,GAAGO,UAAY,iBAAgBP,GAAW,GAAK,aAAe,aAGnK,SAASQ,aAAaC,GAClB,OAAOC,KAAKC,MAAMF,EAASG,OAG/B,SAASC,YAAYJ,GACjB,OAAOK,SAASL,EAASG,OAG7BnB,EAAE,eAAesB,GAAG,SAAS,WACzBlB,eAAemB,YAAY,UAE3B,MAAMC,EAAUT,aAAaf,EAAE,aACzByB,EAAOzB,EAAE,SAASmB,MACX,OAATM,GACI,CAAC,YAAa,aAAaC,SAASF,EAAQG,QAC5CH,EAAQI,UAAY,IAG5B,MAAMC,EAAOd,aAAaf,EAAE,UACtB8B,EAAQV,YAAYpB,EAAE,WACtB+B,EAAmBX,YAAYpB,EAAE,aACjCgC,EAASZ,YAAYpB,EAAE,YAiC7BiC,QAAQC,IAAI,IAAIC,MAAM,KAAKC,IAAI,CAACC,EAAGC,IA/BnC,SAA+BC,GAC3B,MAAMC,GAAoC,GAAzBhB,EAAQiB,OAASF,GAAYT,EAAQ,KAAQ,GAAKA,EAAQ,GACrEY,GAAuBF,GAAST,EAAmB,MAAS,GAAK,GAAM,EAC7E,IAAIY,EAAsB,IAARH,EAAeX,EAAKe,YAAe,EACjDF,EAAoB,IACpBC,EAAYA,EAAWD,GAAsB,GAEjDC,EAAWE,KAAKC,IAAIH,EAAU,KAC9B,MAAMI,EAAgB,CAClBnB,UAAcJ,EAAQI,UACtBoB,iBAAqBnB,EAAKmB,iBAC1BC,YAAepB,EAAKqB,QACpBC,YAAetB,EAAKuB,QACpBpB,OAAWA,EACXW,SAAaA,EACbU,aAAiB1D,wBAAwB8B,GAAM,GAC/C6B,aAAiB3D,wBAAwB8B,GAAM,GAC/C8B,WAAezD,gBAAgB2B,GAC7B1B,YAAY8B,EAAK2B,WAAWhB,EAAM,GAAGE,EAAkB,GACvD,IAAiB,KAAXV,GAAiB,IAAiB,KAAXA,GAC7B,GAAM,CAAC,aAAc,eAAeN,SAASG,EAAK4B,WAExD,OAAO,IAAIxB,QAAQ,CAACyB,EAASC,KACzB,MAAMC,EAAkB,IAAIC,OAAO,yBACnCD,EAAgBE,UAAY,SAAUC,GAClCL,EAAQK,EAAE9D,OAEd2D,EAAgBI,YAAYjB,KAIKkB,CAAsB3B,KAAK4B,KAAKC,IACrE,IAAIC,EAAa,EACbC,EAAe,EACnBF,EAAQG,SAAQ,SAAUC,GACtBH,GAAcG,EAAO,GACrBF,GAAgBE,EAAO,MAE3BnE,eAAeoE,SAAS,UACxBnE,WAAWH,cAAekE,EAAa,WACvC/D,WAAWF,gBAAiB,IAAMkE,EAAe,SAIzDrE,EAAE,UAAUsB,GAAG,UAAU,WACrBmD,KAAKC,MAAQ7B,KAAKC,IAAID,KAAK8B,IAAIF,KAAKC,MAAO,GAAI","file":"../js/index.js","sourcesContent":["const gameSpecificCycleCounts = {\r\n    RB: [520, 564],\r\n    Y: [516, 560]\r\n}\r\nconst gameRoll2Counts = {\r\n    RB: 0,\r\n    Y: 152\r\n}\r\nconst roll2Counts = $('#roll2Counts').data('roll2counts');\r\nvar actualRateBar = $('.actualRateGroup');\r\nvar intendedRateBar = $('.intendedRateGroup');\r\nvar loadingSpinner = $('.spinner-border');\r\n\r\nfunction setRateBar(progressElement, percent) {\r\n    percent = parseFloat(percent).toFixed(2);\r\n    progressElement.find('p.rate').html(`${percent}%`);\r\n    progressElement.find('.progress-bar').css(\"width\", `${percent}%`).attr(\"aria-valuenow\", percent)[0].className = `progress-bar ${percent >= 50 ? 'bg-success' : 'bg-danger'}`;\r\n}\r\n\r\nfunction getJsonValue($element) {\r\n    return JSON.parse($element.val());\r\n}\r\n\r\nfunction getIntValue($element) {\r\n    return parseInt($element.val());\r\n}\r\n\r\n$('form button').on('click', function () {\r\n    loadingSpinner.removeClass('d-none');\r\n\r\n    const pokemon = getJsonValue($('#species'));\r\n    const game = $('#game').val();\r\n    if (game === \"RB\") {\r\n        if ([\"DRAGONAIR\", \"DRAGONITE\"].includes(pokemon.name)) {\r\n            pokemon.catchRate = 45;\r\n        }\r\n    }\r\n    const ball = getJsonValue($('#ball'));\r\n    const level = getIntValue($('#level'));\r\n    const currentHPPercent = getIntValue($('#hpRange'));\r\n    const status = getIntValue($('#status'));\r\n\r\n    function createCatchRateWorker(hpDV) {\r\n        const maxHP = (((pokemon.baseHP + hpDV) * 2 * level / 100) >> 0) + level + 10;\r\n        const currentHPModifier = (((maxHP * (currentHPPercent / 100)) >> 0) / 4) >> 0;\r\n        let hpFactor = (((maxHP * 255) / ball.ballFactor) >> 0);\r\n        if (currentHPModifier > 0) {\r\n            hpFactor = (hpFactor / currentHPModifier) >> 0;\r\n        }\r\n        hpFactor = Math.min(hpFactor, 255);\r\n        const catchRateData = {\r\n            \"catchRate\" : pokemon.catchRate,\r\n            \"ballRerollCutoff\" : ball.ballRerollCutoff,\r\n            \"ballReroll1\": ball.reroll1,\r\n            \"ballReroll2\": ball.reroll2,\r\n            \"status\" : status,\r\n            \"hpFactor\" : hpFactor,\r\n            \"reroll1Count\" : gameSpecificCycleCounts[game][0],\r\n            \"reroll2Count\" : gameSpecificCycleCounts[game][1],\r\n            \"roll2Count\" : gameRoll2Counts[game]\r\n            + roll2Counts[ball.ballIndex][maxHP-1][currentHPModifier-1] \r\n            + 48 * (status === 12) + 52 * (status === 25)\r\n            + 60 * ([\"Ultra Ball\", \"Safari Ball\"].includes(ball.ballName))\r\n        }\r\n        return new Promise((resolve, reject) => {\r\n            const catchRateWorker = new Worker('js/catchRateWorker.js');\r\n            catchRateWorker.onmessage = function (e) {\r\n                resolve(e.data);\r\n            }\r\n            catchRateWorker.postMessage(catchRateData);\r\n        });\r\n    }\r\n\r\n    Promise.all([...Array(16)].map((x, i) => createCatchRateWorker(i))).then(results => {\r\n        let actualRate = 0;\r\n        let intendedRate = 0;\r\n        results.forEach(function (result) {\r\n            actualRate += result[0];\r\n            intendedRate += result[1];\r\n        });\r\n        loadingSpinner.addClass('d-none');\r\n        setRateBar(actualRateBar, actualRate / 671088.64);\r\n        setRateBar(intendedRateBar, 100 * intendedRate / 16);\r\n    });\r\n});\r\n\r\n$('#level').on('change', function () {\r\n    this.value = Math.min(Math.max(this.value, 2), 70);\r\n});"]}